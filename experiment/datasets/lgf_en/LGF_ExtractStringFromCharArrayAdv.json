{"title": "Advanced String Extractor from Character Array", "name": "LGF_ExtractStringFromCharArrayAdv", "description": "The function extracts a String specified by a text before and after from an array of characters with extended options.", "type": "FUNCTION", "input": [{"name": "textBefore", "type": "String", "description": "Text in front of the characters which has to be extracted"}, {"name": "textAfter", "type": "String", "description": "Text behind the characters which has to be extracted"}, {"name": "includeBeforeAfter", "type": "Bool", "description": "TRUE: textBefore and textAfter are included in the extracted string"}, {"name": "startPos", "type": "DInt", "description": "Position within the array to start search from (index zero based)"}], "output": [{"name": "extractedString", "type": "String", "description": "Extracted string"}, {"name": "position", "type": "DInt", "description": "Position (index) within the array where text begins (index zero based)"}, {"name": "length", "type": "Int", "description": "Length of text that was extracted"}, {"name": "status", "type": "Word", "description": "Status of the FB"}], "in/out": [{"name": "searchIn", "type": "Variant", "description": "Array of Character or Byte to search in"}], "return_value": [{"type": "Word", "description": "Return value: Status of the FB"}], "status_codes": {"16#0000": "STATUS_NO_ERROR", "16#8200": "ERR_NO_ARRAY", "16#9001": "WARNING_ONLY_START", "16#9002": "WARNING_NOTHING_FOUND"}, "user_defined_types": [], "description_zh": "\n该函数用于从字符数组中提取一个由前后文本指定的字符串，并具有扩展选项。函数接受两个字符串参数textBefore和textAfter，用于指定要提取的字符串的前后文本。参数includeBeforeAfter决定是否在提取的字符串中包含前后文本。参数startPos指定在数组中开始搜索的位置（基于零的索引）。函数输出extractedString为提取的字符串，position为文本在数组中的起始位置（基于零的索引），length为提取文本的长度，status为函数块的状态。\n\n函数首先验证输入是否为字符或字节数组，并读取数组元素的数量。然后，它使用一个循环搜索数组，尝试找到与textBefore匹配的文本。如果找到了textBefore，它会根据includeBeforeAfter参数调整位置，并创建一个新的字符串以搜索textAfter。如果找到了textAfter，它会根据includeBeforeAfter参数截取字符串，并更新输出参数。如果在数组结束时没有找到textAfter，它会输出从textBefore之后开始的整个字符串。\n\n函数的状态码有STATUS_NO_ERROR表示没有错误，ERR_NO_ARRAY表示输入不是数组，WARNING_ONLY_START表示只找到了起始文本，WARNING_NOTHING_FOUND表示没有找到任何文本。\n\n\n"}