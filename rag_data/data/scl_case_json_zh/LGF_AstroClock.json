{"title": "GPS-based Sunrise and Sunset Time Determination", "name": "LGF_AstroClock", "description": "This function calculates the times of sunrise and sunset based on the local time for a specific place on Earth.", "type": "FUNCTION_BLOCK", "input": [{"name": "enable", "type": "Bool", "description": "TRUE: Activates the functionality of the FB"}, {"name": "positionGps", "type": "LGF_typeGPS_DD", "description": "GPS position to calculate the time of sunrise and sunset"}, {"name": "offsetSunrise", "type": "Time", "description": "Offset to sunrise (added to sunrise time, considered at `isDaytime`, negative time allowed)"}, {"name": "positionGps", "type": "Time", "description": "Offset to sunset (added to sunset time, considered at `isDaytime`, negative time allowed)"}], "output": [{"name": "valid", "type": "Bool", "description": "TRUE: Valid set of output values available at the FB"}, {"name": "busy", "type": "Bool", "description": "TRUE: FB is active and new output values can be expected"}, {"name": "error", "type": "Bool", "description": "FALSE: No error / TRUE: An error occurred during the execution of the FB"}, {"name": "status", "type": "Word", "description": "16#0000-16#7FFF: Status of the FB / 16#8000-16#FFFF: Error identification"}, {"name": "subFunctionStatus", "type": "Word", "description": "Status or return value of called FB's, FC's and system blocks"}, {"name": "actualLocalTime", "type": "DTL", "description": "Current time (local time)"}, {"name": "sunriseTime", "type": "DTL", "description": "Sunrise time (localtime)"}, {"name": "sunsetTime", "type": "DTL", "description": "Sunset time (localtime)"}, {"name": "isDaytime", "type": "Bool", "description": "TRUE: If the local time of the controller is between “sunrise” and “sunset”"}], "in/out": [], "return_value": [], "status_codes": {"16#0000": "STATUS_EXECUTION_FINISHED_NO_ERROR", "16#7000": "STATUS_NO_CALL", "16#7001": "STATUS_IN_OPERATION", "16#8204": "ERR_LATITUDE_VALUE", "16#8205": "ERR_LONGITUDE_VALUE", "16#8601": "ERR_RD_SYS_T", "16#8602": "ERR_RD_LOC_T"}, "user_defined_types": [{"name": "LGF_typeGPS_DD", "description": "Datatype for GPS Coordinates in decimal degrees. For a whole GPS Data set.", "member": [{"name": "latitude", "type": "Real", "default": "0.0", "description": "Degrees latitude with decimal places (Unit: degree decimal), North = positive; South = negative) valid value range [-90.00000..90.00000] "}, {"name": "longitude", "type": "Real", "default": "0.0", "description": "Degrees longitude with decimal places (Unit: degree decimal), East = positive; West = negative) valid value range [-180.00000..180.00000] "}]}], "description_zh": "\n该SCL案例代码实现的函数块名为 \"LGF_AstroClock\"，主要用于计算特定地球上某地的日出和日落时间。它接受GPS位置信息（纬度和经度），并考虑了日出和日落时间的偏移量。该函数块能够判断当前时间是否处于白天，并提供有效的输出值。\n\n函数块的主要逻辑如下：\n\n1. 初始化：当使能信号（enable）从FALSE变为TRUE时，函数块开始初始化，设置忙状态（busy）为TRUE，并进入操作状态。\n\n2. 处理天文时钟计算：如果使能信号保持TRUE，函数块将执行以下操作：\n   a. 读取系统时间和官方当地时间，并计算时区差。\n   b. 计算当前的日期是一年中的哪一天。\n   c. 检查输入的GPS位置值是否有效（纬度和经度必须在规定范围内）。\n   d. 计算日出时间：使用一系列公式和近似值来计算当地的日出时间，并将计算结果存储在临时变量中。\n   e. 计算日落时间：使用类似的公式和近似值来计算当地的日落时间，并将计算结果存储在临时变量中。\n\n3. 输出：将计算得到的日出时间、日落时间和当前时间（当地时间）写入到对应的输出变量中。同时，根据当前时间是否在日出和日落时间之间，设置 isDaytime 输出。\n\n4. 错误处理：如果在计算过程中发生错误（如读取系统时间或当地时间失败，或输入的GPS位置值无效），函数块将设置错误状态（error）为TRUE，并将相应的状态码写入到 status 输出变量中。\n\n5. 其他输出：根据计算结果和状态，设置 valid、busy 和 error 输出。ENO 信号被设置为 TRUE，表示没有使用错误处理。\n\n总之，该函数块通过复杂的计算和近似值，可以根据给定的GPS位置和时间偏移量，计算出当地的日出和日落时间，并判断当前是否处于白天。\n\n\n"}