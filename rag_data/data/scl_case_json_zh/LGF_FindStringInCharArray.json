{"title": "String Position Finder in Character Array", "name": "LGF_FindStringInCharArray", "description": "The function searches for a specified String within an array of characters. Returning the position of the String in the Array, if the string is not found the return value is -1.", "type": "FUNCTION", "input": [{"name": "searchFor", "type": "String", "description": "Text that is searched for"}, {"name": "startPos", "type": "DInt", "description": "Position within the array to start search from (index zero based)"}], "output": [{"name": "status", "type": "Word", "description": "Status of the FB"}], "in/out": [{"name": "searchIn", "type": "Variant", "description": "Array of Character or Byte to search in"}], "return_value": [{"type": "DInt", "description": "Position (index) of the first character of the text that is searched for within the input array (index zero based). Return -1 if nothing found."}], "status_codes": {"16#0000": "STATUS_NO_ERROR", "16#8200": "ERR_NO_ARRAY"}, "user_defined_types": [], "description_zh": "\n函数 \"LGF_FindStringInCharArray\" 的主要功能是在一个字符数组中搜索一个指定的字符串，并返回该字符串在数组中的位置。如果字符串未找到，则返回值为 -1。\n\n输入参数：\n- searchFor (String): 要搜索的文本字符串。\n- startPos (DInt): 在数组中开始搜索的位置（基于零的索引）。\n\n输出参数：\n- status (Word): 函数块的状态码。\n\nInOut 参数：\n- searchIn (Variant): 要在其中搜索的字符或字节数组。\n\n返回值：\n- item (DInt): 在输入数组中搜索的文本的第一个字符的位置（基于零的索引）。如果未找到，则返回 -1。\n\n状态码：\n- 16#0000: STATUS_NO_ERROR（没有错误）。\n- 16#8200: ERR_NO_ARRAY（输入不是一个数组）。\n\n函数首先初始化一些临时变量，并验证输入参数 searchIn 是否为一个数组，其元素类型是否为 CHAR 或 BYTE。如果验证失败，函数将状态码设置为 ERR_NO_ARRAY 并终止执行。\n\n验证成功后，函数将进入一个循环，在数组中搜索指定的字符串。循环中，函数将数组中的一段字符转换为字符串，并使用 FIND 函数在转换后的字符串中搜索指定的字符串。如果在当前搜索的字符串中找到指定的字符串，则计算其在原始数组中的位置，并将该位置作为函数的返回值。如果未找到，则继续在数组的下一个部分搜索，直到找到字符串或搜索完整个数组。\n\n函数使用一个临时字符串 tempString 来存储从数组中转换的字符，并且每次循环中 tempString 的长度被设置为常量 LEN_STRING（254）和 searchFor 字符串长度之间的较小值。这样可以确保不会将关键字在字符串的末尾拆分，从而避免遗漏。\n\n如果循环结束后仍未找到指定的字符串，函数将返回 -1，表示字符串在数组中不存在。\n\n\n"}