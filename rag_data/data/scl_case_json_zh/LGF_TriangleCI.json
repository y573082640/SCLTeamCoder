{"title": "Triangular Signal Generator", "name": "LGF_TriangleCI", "description": "This function generates a triangular signal profile. For this it uses the time interval of the calling Cyclic Interrupt OB.", "type": "FUNCTION_BLOCK", "input": [{"name": "amplitude", "type": "Real", "description": "1.0"}, {"name": "offset", "type": "Real", "description": "0.0"}, {"name": "periode", "type": "UDInt", "description": "1000"}, {"name": "phaseShift", "type": "Real", "description": "0.0"}, {"name": "callOB", "type": "OB_CYCLIC", "description": ""}, {"name": "reset", "type": "Bool", "description": "FALSE"}], "output": [{"name": "value", "type": "Real", "description": "Current value of the triangular signal."}, {"name": "error", "type": "Bool", "description": "FALSE: No error"}, {"name": "status", "type": "Word", "description": "16#0000-16#7FFF: Status of the FB 16#8000-16#FFFF: Error identification"}, {"name": "subFunctionStatus", "type": "Word", "description": "Status or return value of called FB's, FC's and system blocks"}], "in/out": [], "return_value": [], "status_codes": {"16#0000": "STATUS_FINISHED_NO_ERROR", "16#8600": "ERR_OB_UNAVAILABLE", "16#8601": "ERR_QRY_CINT"}, "user_defined_types": [], "description_zh": "\n该案例是一个生成三角波信号的函数块（FB），名为“LGF_TriangleCI”。它利用调用它的周期性中断组织块（OB）的时间间隔来生成信号。输入参数包括振幅（amplitude）、偏移（offset）、周期（periode）、相移（phaseShift）、调用OB（callOB）和重置（reset）信号。输出参数包括当前信号值（value）、错误状态（error）、状态字（status）和子函数状态字（subFunctionStatus）。\n\n该函数块的主要逻辑如下：\n\n1. 获取采样时间：根据提供的周期性中断OB的编号，使用QRY_CINT函数获取OB的周期（tempCycleTime）和相位（tempCyclePhase）。如果QRY_CINT函数返回错误或OB不可用，则设置错误状态并返回。\n\n2. 计算信号值：\n   - 如果收到重置信号，则将计数器（statCounter）和临时值（tempValue）重置为0。\n   - 否则，每次调用周期性中断OB时，计数器会增加与OB周期相对应的值，并对周期进行取模运算以保持其在指定周期内。\n   - 计算考虑相移的真实相移值。\n   - 使用三角波公式计算当前信号值，该值是通过对称的斜线和偏移量进行绝对值运算后减去振幅得到的。\n   - 将计算出的信号值加上偏移量，得到最终的输出值。\n\n3. 设置输出和状态：\n   - 将计算出的信号值赋给输出参数value。\n   - 设置错误状态为FALSE，状态字为STATUS_FINISHED_NO_ERROR，表示执行没有错误。\n   - 不使用ENO机制，强制设置为TRUE。\n\n该函数块通过上述逻辑可以在每个OB周期内生成一个三角波形的信号，并可通过重置信号来重新开始波形生成。\n\n\n"}