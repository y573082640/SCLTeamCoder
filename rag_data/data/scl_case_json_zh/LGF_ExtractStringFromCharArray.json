{"title": "String Extractor from Character Array", "name": "LGF_ExtractStringFromCharArray", "description": "The function extracts a String specified by a text before and after from an array of characters.", "type": "FUNCTION", "input": [{"name": "textBefore", "type": "String", "description": "Text in front of the characters which has to be extracted"}, {"name": "textAfter", "type": "String", "description": "Text behind the characters which has to be extracted"}], "output": [{"name": "extractedString", "type": "String", "description": "Extracted string"}, {"name": "status", "type": "Word", "description": "Status of the FB"}], "in/out": [{"name": "searchIn", "type": "Variant", "description": "Array of Character or Byte to search in"}], "return_value": [{"type": "Word", "description": "Status of the FB"}], "status_codes": {"16#0000": "STATUS_TEXT_FOUND", "16#8200": "ERR_NO_ARRAY", "16#9001": "WARNING_ONLY_START", "16#9002": "WARNING_NOTHING_FOUND"}, "user_defined_types": [], "description_zh": "\n该函数\"LGF_ExtractStringFromCharArray\"旨在从字符数组中提取出一个由前缀和后缀文本指定的字符串。它接受两个字符串参数\"textBefore\"和\"textAfter\"，分别表示要提取的字符串前后的文本。函数的输入参数还包括一个变体类型的数组\"searchIn\"，其中包含了要搜索的字符或字节。\n\n函数的主要逻辑如下：\n\n1. 首先验证输入参数\"searchIn\"是否为一个数组，并且数组元素的类型是否为字符（Char）或字节（Byte）。如果验证失败，则函数返回错误状态ERR_NO_ARRAY并终止执行。\n\n2. 初始化一些临时变量，包括数组中的元素数量、当前搜索位置、前后缀文本的长度等。\n\n3. 进入一个循环，不断在数组中搜索前缀文本\"textBefore\"。\n\n4. 每次循环中，将数组中的一段字符转换为字符串，然后在该字符串中搜索前缀文本。\n\n5. 如果找到了前缀文本，则更新当前搜索位置到前缀文本的末尾，并再次将数组中的一段字符转换为字符串。\n\n6. 在新的字符串中搜索后缀文本\"textAfter\"。\n\n7. 如果找到了后缀文本，则提取从后缀文本开始到前缀文本末尾的字符串，并设置状态为STATUS_TEXT_FOUND。如果没有找到后缀文本，则提取从后缀文本开始到字符串末尾的字符串，并设置状态为WARNING_ONLY_START。\n\n8. 如果在数组中搜索到了前缀和后缀文本，则将提取的字符串存储在\"extractedString\"输出参数中，并返回状态STATUS_TEXT_FOUND。如果在数组中只找到了前缀文本，则返回状态WARNING_ONLY_START。如果在数组中都没有找到，则返回状态WARNING_NOTHING_FOUND。\n\n函数的输出参数包括：\n\n- extractedString (String): 提取的字符串\n- status (Word): 函数的状态\n\n函数的状态代码包括：\n\n- 16#0000: STATUS_TEXT_FOUND，表示成功找到了前缀和后缀文本，并提取了字符串\n- 16#8200: ERR_NO_ARRAY，表示输入参数\"searchIn\"不是一个字符或字节数组\n- 16#9001: WARNING_ONLY_START，表示只找到了前缀文本，没有找到后缀文本\n- 16#9002: WARNING_NOTHING_FOUND，表示没有找到前缀和后缀文本\n\n\n"}