{"variables": [], "instructions": [], "planning": "\n- 概述\n这段代码定义了一个名为“LGF_TimerSwitch”的功能块，它根据指定的模式和时间参数控制一个信号的输出。功能块支持多种模式，包括每天、每周、每月、每年、工作日和周末。\n\n- 变量定义\n代码中定义了以下几类变量：\n- 输入变量：开启月份、开启日期、开启星期几、开启小时、开启分钟、关闭月份、关闭日期、关闭星期几、关闭小时、关闭分钟、模式\n- 输出变量：信号、实际本地时间、错误、状态、子功能状态\n- 临时变量：临时时间、临时读取时间状态、临时开启时间、临时开启时间TOD、临时关闭时间、临时关闭时间TOD、临时实际时间、临时实际时间TOD\n- 常量：零、清除DTL、无错误状态、无模式选择错误、读取本地时间错误、永久关闭模式、每天模式、每周模式、每月模式、每年模式、工作日模式、周末模式、永久开启模式、一月、十二月、星期一、星期五、星期六、星期日、下星期日、下星期一、日期增量、天增量、周增量、每周天数、默认年份、默认月份\n\n- \n- 主逻辑部分\n-- REGION BLOCK INFO HEADER\n   此区域包含功能块的元信息，简单描述。\n-- REGION DESCRIPTION\n   此区域目前为空，但可以包含功能块的简单描述。\n-- REGION INITIALISATION\n   此区域初始化开启和关闭时间的结构体，设置小时、分钟、秒和纳秒。\n-- REGION READ LOCAL TIME\n   此区域读取本地时间，并检查是否有错误发生。如果有错误，则设置错误标志，写入状态和子功能状态，清除信号和实际本地时间，并返回。\n-- REGION TIMER SWITCH LOGIC\n   此区域根据选择的模式执行不同的逻辑：\n   - #MODE_DAILY\n       此模式将开启和关闭时间设置为当前日期，并检查开启时间是否大于关闭时间。如果是，则根据实际时间调整日期。\n       - 检查开启时间TOD是否大于关闭时间TOD。\n         - 如果是，则检查实际时间TOD是否大于关闭时间TOD。\n           - 如果是，则增加关闭时间的日期。\n           - 否则，减少开启时间的日期。\n   - #MODE_WEEKLY\n       此模式将开启和关闭时间设置为默认日期，并根据星期几进行调整。如果开启时间大于关闭时间，则增加关闭时间的日期。\n       - 检查开启日期是否大于关闭日期或者开启日期等于关闭日期且开启时间TOD大于关闭时间TOD。\n         - 如果是，则增加关闭日期的天数。\n         - 检查开启日期是否大于实际日期的星期几或者开启日期等于关闭日期且开启时间TOD小于关闭时间TOD。\n           - 如果是，则增加实际日期的天数。\n   - #MODE_MONTHLY\n       此模式将开启和关闭时间设置为当前年份和月份，并检查开启日期是否大于关闭日期。如果是，则根据实际时间调整月份和年份。\n       - 检查开启日期是否大于关闭日期或者开启日期等于关闭日期且开启时间TOD大于关闭时间TOD。\n         - 如果是，则检查实际日期是否大于关闭日期或者实际日期等于关闭日期且实际时间TOD大于关闭时间TOD。\n           - 如果是，则增加关闭时间的月份，如果已经是12月，则增加年份并重置月份为1。\n           - 否则，减少开启时间的月份，如果已经是1月，则减少年份并重置月份为12。\n   - #MODE_YEARLY\n       此模式将开启和关闭时间设置为当前年份，并检查开启月份是否大于关闭月份。如果是，则根据实际时间调整年份。\n       - 检查开启月份是否大于关闭月份或者开启月份等于关闭月份且开启时间TOD大于关闭时间TOD。\n         - 如果是，则检查实际月份是否大于关闭月份或者实际月份等于关闭月份且实际时间TOD大于关闭时间TOD。\n           - 如果是，则增加关闭时间的年份。\n           - 否则，减少开启时间的年份。\n   - #MODE_WEEK_DAYS\n       此模式将开启和关闭时间设置为默认日期，并根据星期几进行调整，确保时间在工作日范围内。\n       - 检查开启时间TOD是否大于关闭时间TOD。\n         - 如果是，则检查实际时间TOD是否大于关闭时间TOD。\n           - 如果是，则增加关闭时间的日期。\n           - 否则，减少开启时间的日期。\n       - 检查开启日期是否小于星期一，如果是，则将开启日期设置为星期一。\n       - 检查开启日期是否大于星期五，如果是，则将开启日期设置为星期五。\n       - 检查关闭日期是否大于星期五且开启时间TOD大于关闭时间TOD，如果是，则将关闭日期设置为星期六。\n       - 检查关闭日期是否大于星期五，如果是，则将关闭日期设置为星期五。\n   - #MODE_WEEKEND_DAYS\n       此模式将开启和关闭时间设置为默认日期，并根据星期几进行调整，确保时间在周末范围内。\n       - 检查开启日期是否小于星期六，如果是，则将开启日期增加7天。\n       - 检查关闭日期是否小于星期六，如果是，则将关闭日期增加7天。\n       - 检查实际日期是否小于星期六，如果是，则将实际日期增加7天。\n       - 检查开启时间TOD是否大于关闭时间TOD。\n         - 如果是，则检查实际时间TOD是否大于关闭时间TOD。\n           - 如果是，则增加关闭时间的日期。\n           - 否则，减少开启时间的日期。\n       - 检查开启日期是否小于星期六，如果是，则将开启日期设置为星期六。\n       - 检查开启日期是否大于下星期日，如果是，则将开启日期设置为下星期日。\n       - 检查关闭日期是否大于下星期日且开启时间TOD大于关闭时间TOD，如果是，则将关闭日期设置为下星期一。\n       - 检查关闭日期是否大于下星期日，如果是，则将关闭日期设置为下星期日。\n   - #MODE_PERMANENTLY_ON\n       此模式不做任何操作，信号始终为真。\n   - #MODE_PERMANENTLY_OFF\n       此模式不做任何操作，信号始终为假。\n   - ELSE\n       如果模式无效，则设置错误标志，写入状态和子功能状态，清除信号和实际本地时间，并返回。\n-- REGION OUTPUT\n   此区域将临时时间写入实际本地时间，并根据模式和时间的比较结果设置信号。最后，清除错误标志，设置状态和子功能状态，并强制ENO为真。\n\n\n", "name": "LGF_TimerSwitch"}