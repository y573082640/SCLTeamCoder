{"variables": [], "instructions": [], "planning": "\n- 概述\n这段代码是一个名为“LGF_AstroClock”的SCL功能块，用于计算日出、日落时间和是否为白天。它接受GPS位置、日出偏移和日落偏移作为输入，并输出当地实际时间、日出时间、日落时间和是否为白天。\n- 变量定义\n代码中定义了以下几类变量：\n - 输入变量：使能、位置GPS、日出偏移、日落偏移\n - 输出变量：有效、忙、错误、状态、子函数状态、实际当地时间、日出时间、日落时间、是白天\n - 内部变量：使能旧状态、忙、状态、子函数状态、经度小时、纬度弧度\n - 临时变量：返回值、系统时间、官方当地时间、1月1日日期、日出时间、日落时间、时区、一年中的日子、近似时间、太阳平均异常、太阳经度、太阳平均半径、太阳经度弧度、太阳升交点、太阳升交点弧度、正弦倾角、余弦倾角、余弦当地小时角、当地小时角、当地平均时间、UTC、当地时间\n - 常量：夏令时子状态、无错误、执行完成无错误、无调用、操作中、纬度值错误、经度值错误、读取系统时间错误、读取当地时间错误、0度、15度、90度、180度、360度、圆周率、度转弧度、弧度转度、太阳天顶、最大分秒59、每小时的秒数、每小时的分钟数、每天的小时数、每小时毫秒数、时间零、第一个月和日、近似时间6、近似时间18、太阳平均异常0.9856、太阳平均异常3.289、太阳真实经度0.02、太阳真实经度1.916、太阳真实经度2.0、太阳真实经度282.634、太阳升交点0.91764、太阳升交点2.0、太阳升交点2π、太阳倾角0.39782、当地小时角和、当地平均时间0.06571、当地平均时间6.622\n- \n- 主逻辑部分\n-- REGION BLOCK INFO HEADER\n   此区域包含功能块的元信息，简单描述。\n-- REGION DESCRIPTION\n   此区域目前为空，但可以包含功能块的简单描述。\n-- REGION Extended description\n   此区域提供功能块的详细描述，包括功能、输入格式、输出格式和使用建议。\n-- REGION Block processing\n   此区域处理功能块的计算逻辑。首先，检查使能输入是否从假变为真，并且状态为“无调用”。如果是，则初始化功能块，将忙设置为真，状态设置为“操作中”，子函数状态设置为“无错误”。然后，检查使能输入是否从真变为假。如果是，则禁用功能块，将忙设置为假，状态设置为“无调用”，子函数状态设置为“无错误”。最后，如果使能输入为真且上一个周期也为真，则执行天文时钟计算。\n   - REGION System time, local time, time zone\n     此区域读取系统时间和官方当地时间，并计算时区差异。首先，使用RD_SYS_T函数读取系统时间UTC，并将其存储在临时变量中。然后，检查返回值是否为“无错误”。如果不是，则将状态设置为“读取系统时间错误”，并将返回值存储在子函数状态中。接下来，使用RD_LOC_T函数读取官方当地时间，并将其存储在临时变量中。同样，检查返回值是否为“无错误”或“夏令时子状态”。如果不是，则将状态设置为“读取当地时间错误”，并将返回值存储在子函数状态中。最后，计算系统时间和官方当地时间之间的差异，并将其转换为小时，存储在时区变量中。\n   - REGION Day of the year\n     此区域计算当前日期是一年中的第几天。首先，将官方当地时间的年份、月份和日期存储在临时变量中。然后，将1月1日的日期设置为与官方当地时间相同的年份，月份和日期都为1。接着，计算当前日期与1月1日之间的差异，并将其加1，得到一年中的日子。\n   - REGION input value check\n     此区域检查输入的纬度和经度值是否有效。首先，检查纬度值是否大于90度。如果是，则将状态设置为“纬度值错误”。然后，检查经度值是否大于180度。如果是，则将状态设置为“经度值错误”。最后，将输入的纬度和经度值转换为弧度，并存储在内部变量中。\n   - REGION Calculate Sunrise\n     此区域计算日出时间。首先，计算近似时间。然后，计算太阳的平均异常、真实经度、升交点和倾角。接着，计算太阳的当地小时角和当地平均时间。最后，将当地平均时间转换为UTC，并加上时区差异和日出偏移，得到日出时间。\n   - REGION Calculate Sunset\n     此区域计算日落时间。计算过程与计算日出时间类似，但使用不同的近似时间和计算当地小时角的方法。\n-- REGION OUTPUTS\n   此区域将计算结果和内部变量的值写入输出变量。首先，将实际当地时间、日出时间和日落时间写入输出。然后，根据当前时间和日出/日落时间，判断是否为白天。最后，将有效、忙、错误、状态和子函数状态写入输出。\n\n\n", "name": "LGF_AstroClock"}